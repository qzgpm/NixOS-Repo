#!/bin/sh

# --- Editors ---
# Prefer Neovim when available
if command -v nvim >/dev/null 2>&1; then
  alias \
    vim="nvim" \
    vimdiff="nvim -d"
fi

# --- X session ---
# Use custom XINITRC if it exists
[ -n "$XINITRC" ] && [ -f "$XINITRC" ] && alias startx="startx $XINITRC"

# --- Sudo shortcuts ---
for command in mount umount sv nixos-rebuild updatedb su shutdown poweroff reboot; do
  alias "$command"="sudo $command"
done
unset command

# --- Local script editor ---
se() {
  choice="$(find ~/.local/bin -mindepth 1 -printf '%P\n' | fzf)"
  [ -f "$HOME/.local/bin/$choice" ] && "$EDITOR" "$HOME/.local/bin/$choice"
}

# --- Git helpers ---
commitFunction() {
  git commit -m "$*"
}

pushFunction() {
  branch="$(git rev-parse --abbrev-ref HEAD 2>/dev/null)"
  if [ -n "$branch" ]; then
    git push -u origin "$branch"
  else
    echo "Not a git repository"
  fi
}

pullFunction() {
  branch="$(git rev-parse --abbrev-ref HEAD 2>/dev/null)"
  if [ -n "$branch" ]; then
    git pull origin "$branch"
  else
    echo "Not a git repository"
  fi
}

# --- Verbosity and defaults ---
alias \
  cp="cp -iv" \
  mv="mv -iv" \
  ln="ln -i" \
  rm="rm -vI" \
  bc="bc -ql" \
  ka="killall" \
  du="dust -d 2 --reverse" \
  python="python -q" \
  less="bat --paging=always --plain" \
  nixos-rebuild="nixos-rebuild --flake $HOME/.dotfiles#laptop"

# --- Colorized commands ---
alias \
  ls="eza -h --icons --group-directories-first --color=always" \
  grep="grep -i --color=auto" \
  diff="diff --color=auto" \
  ip="ip -color=auto" \
  cat="bat -pp"

# --- Misc shortcuts ---
alias \
  lf="lfub" \
  magit="nvim -c MagitOnly" \
  ref="shortcuts >/dev/null; source ${XDG_CONFIG_HOME:-$HOME/.config}/shell/shortcutrc ; \
       source ${XDG_CONFIG_HOME:-$HOME/.config}/shell/shortcutenvrc ; \
       source ${XDG_CONFIG_HOME:-$HOME/.config}/shell/zshnameddirrc"

# --- Git command aliases ---
alias \
  gadd="git add ." \
  gcommit="commitFunction" \
  gpush="pushFunction" \
  gpull="pullFunction"
